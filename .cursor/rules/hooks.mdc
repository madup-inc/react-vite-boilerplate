---
description: 커스텀 훅 생성 규칙
---

# 커스텀 훅 생성 규칙

## 공통 훅 사용

```typescript
// 디바운스
import { useDebounce } from "@/shared/hooks/useDebounce";
const debouncedValue = useDebounce(value, 300);

// 페이지네이션 (URL 동기화)
import { usePagination } from "@/shared/hooks/usePagination";
const { page, pageSize, setPage, setPageSize, reset } = usePagination();

// 정렬 (URL 동기화)
import { useSorting } from "@/shared/hooks/useSorting";
const { sorting, setSorting, toggleSort, reset } = useSorting();

// 다이얼로그
import { useDialog } from "@/shared/hooks/useDialog";
const dialog = useDialog<DataType>();
dialog.open(data);
dialog.close();
dialog.isOpen;
dialog.data;

// 토스트
import { useToast, toast } from "@/shared/hooks/useToast";
toast({ title: "제목", description: "설명" });
toast({ title: "에러", variant: "destructive" });
```

## 필터 훅 패턴 (use[Domain]Filters)

```typescript
// features/[domain]/hooks/use[Domain]Filters.ts
import { useState, useCallback } from "react";
import { useSearchParams } from "react-router-dom";
import { usePagination } from "@/shared/hooks/usePagination";
import { useDebounce } from "@/shared/hooks/useDebounce";
import { [Domain]Filters, [Domain]Status } from "../types";

export function use[Domain]Filters() {
  const [searchParams, setSearchParams] = useSearchParams();
  const { page, pageSize, setPage, setPageSize } = usePagination();

  // 검색어
  const [searchInput, setSearchInput] = useState(searchParams.get("search") || "");
  const debouncedSearch = useDebounce(searchInput, 300);

  // 필터 상태
  const status = (searchParams.get("status") as [Domain]Status) || undefined;

  // 검색어 변경
  const setSearch = useCallback(
    (value: string) => {
      setSearchInput(value);
      setPage(1);
    },
    [setPage]
  );

  // 상태 필터 변경
  const setStatus = useCallback(
    (value: [Domain]Status | undefined) => {
      setSearchParams((prev) => {
        if (value) {
          prev.set("status", value);
        } else {
          prev.delete("status");
        }
        prev.set("page", "1");
        return prev;
      });
    },
    [setSearchParams]
  );

  // 필터 초기화
  const resetFilters = useCallback(() => {
    setSearchInput("");
    setSearchParams((prev) => {
      prev.delete("search");
      prev.delete("status");
      prev.set("page", "1");
      return prev;
    });
  }, [setSearchParams]);

  // 최종 필터 객체
  const filters: [Domain]Filters = {
    page,
    pageSize,
    search: debouncedSearch || undefined,
    status,
  };

  const hasActiveFilters = !!(debouncedSearch || status);

  return {
    filters,
    searchInput,
    setSearch,
    setStatus,
    page,
    pageSize,
    setPage,
    setPageSize,
    resetFilters,
    hasActiveFilters,
  };
}
```

## 컬럼 정의 훅 패턴 (use[Domain]Columns)

```typescript
// features/[domain]/hooks/use[Domain]Columns.tsx
import { useMemo } from "react";
import { ColumnDef } from "@tanstack/react-table";
import { MoreHorizontal, Pencil, Trash2 } from "lucide-react";
import { Link } from "react-router-dom";
import { [Domain] } from "../types";
import { Badge } from "@/shared/components/ui/badge";
import { Button } from "@/shared/components/ui/button";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/shared/components/ui/dropdown-menu";
import { Checkbox } from "@/shared/components/ui/checkbox";
import { DataTableColumnHeader } from "@/shared/components/table/DataTableColumnHeader";
import { formatDate } from "@/shared/libs/date";

interface Use[Domain]ColumnsOptions {
  onEdit?: (item: [Domain]) => void;
  onDelete?: (item: [Domain]) => void;
}

export function use[Domain]Columns({ onEdit, onDelete }: Use[Domain]ColumnsOptions = {}) {
  const columns = useMemo<ColumnDef<[Domain]>[]>(
    () => [
      // 선택 컬럼
      {
        id: "select",
        header: ({ table }) => (
          <Checkbox
            checked={table.getIsAllPageRowsSelected()}
            onCheckedChange={(value) => table.toggleAllPageRowsSelected(!!value)}
          />
        ),
        cell: ({ row }) => (
          <Checkbox
            checked={row.getIsSelected()}
            onCheckedChange={(value) => row.toggleSelected(!!value)}
            onClick={(e) => e.stopPropagation()}
          />
        ),
        enableSorting: false,
        enableHiding: false,
      },
      // 데이터 컬럼
      {
        accessorKey: "name",
        header: ({ column }) => <DataTableColumnHeader column={column} title="이름" />,
        cell: ({ row }) => (
          <Link to={`/[domain]s/${row.original.id}`} className="font-medium text-primary hover:underline">
            {row.getValue("name")}
          </Link>
        ),
      },
      {
        accessorKey: "status",
        header: ({ column }) => <DataTableColumnHeader column={column} title="상태" />,
        cell: ({ row }) => {
          const status = row.getValue("status") as string;
          return <Badge variant={status === "active" ? "success" : "secondary"}>{status}</Badge>;
        },
      },
      {
        accessorKey: "createdAt",
        header: ({ column }) => <DataTableColumnHeader column={column} title="생성일" />,
        cell: ({ row }) => formatDate(row.getValue("createdAt")),
      },
      // 액션 컬럼
      {
        id: "actions",
        cell: ({ row }) => {
          const item = row.original;
          return (
            <DropdownMenu>
              <DropdownMenuTrigger asChild>
                <Button variant="ghost" className="h-8 w-8 p-0" onClick={(e) => e.stopPropagation()}>
                  <MoreHorizontal className="h-4 w-4" />
                </Button>
              </DropdownMenuTrigger>
              <DropdownMenuContent align="end">
                <DropdownMenuItem onClick={() => onEdit?.(item)}>
                  <Pencil className="mr-2 h-4 w-4" />
                  수정
                </DropdownMenuItem>
                <DropdownMenuItem onClick={() => onDelete?.(item)} className="text-destructive">
                  <Trash2 className="mr-2 h-4 w-4" />
                  삭제
                </DropdownMenuItem>
              </DropdownMenuContent>
            </DropdownMenu>
          );
        },
      },
    ],
    [onEdit, onDelete]
  );

  return columns;
}
```

## 훅 인덱스 파일

```typescript
// features/[domain]/hooks/index.ts
export { use[Domain]Filters } from "./use[Domain]Filters";
export { use[Domain]Columns } from "./use[Domain]Columns";
```
